$id: http://example.com/example.json
$schema: http://json-schema.org/draft-07/schema
additionalProperties: false
description: YAML schema for security-insights.yml
properties:
    contribution-policy:
        $id: '#/properties/contribution-policy'
        additionalProperties: false
        properties:
            accepts-pull-requests:
                $id: '#/properties/contribution-policy/properties/accepts-pull-requests'
                type: boolean
            maintainer-policy:
                $id: '#/properties/contribution-policy/properties/maintainer-policy'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
        required:
        - accepts-pull-requests
        type: object
    distribution-points:
        $id: '#/properties/distribution-points'
        additionalItems: false
        items:
            $id: '#/properties/distribution-points/items'
            anyOf:
            -   $id: '#/properties/distribution-points/items/anyOf/0'
                additionalProperties: false
                properties:
                    ecosystem:
                        $id: '#/properties/distribution-points/items/anyOf/0/properties/ecosystem'
                        type: string
                    package-name:
                        $id: '#/properties/distribution-points/items/anyOf/0/properties/package-name'
                        type: string
                    package-url:
                        $id: '#/properties/distribution-points/items/anyOf/0/properties/package-url'
                        type: string
                        pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
                required:
                - package-url
                type: object
        type: array
    header:
        $id: '#/properties/header'
        additionalProperties: false
        properties:
            commit-hash:
                $id: '#/properties/header/properties/commit-hash'
                type: string
                pattern: '^\b[0-9a-f]{5,40}\b$'
            last-reviewed:
                $id: '#/properties/header/properties/last-reviewed'
                type: string
                pattern: '^\d{4}\-(0[1-9]|1[012])\-(0[1-9]|[12][0-9]|3[01])$'
            last-updated:
                $id: '#/properties/header/properties/last-updated'
                type: string
                pattern: '^\d{4}\-(0[1-9]|1[012])\-(0[1-9]|[12][0-9]|3[01])$'
            parent-security-yaml:
                $id: '#/properties/header/properties/parent-security-yaml'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
            project-url:
                $id: '#/properties/header/properties/project-url'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
            project-release:
                $id: '#/properties/header/properties/release'
                type: string
            schema-version:
                $id: '#/properties/header/properties/release'
                type: string
                pattern: '^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$'
        required:
        - parent-security-yaml
        - last-updated
        - last-reviewed
        - commit-hash
        - project-url
        - schema-version
        type: object
    project-lifecycle:
        $id: '#/properties/project-lifecycle'
        additionalProperties: false
        properties:
            bug-fixes-only:
                $id: '#/properties/project-lifecycle/properties/bug-fixes-only'
                type: boolean
            core-maintainers:
                $id: '#/properties/project-lifecycle/properties/core-maintainers'
                additionalItems: false
                items:
                    $id: '#/properties/project-lifecycle/properties/core-maintainers/items'
                    anyOf:
                    -   $id: '#/properties/project-lifecycle/properties/core-maintainers/items/anyOf/0'
                        type: string
                type: array
            roadmap:
                $id: '#/properties/project-lifecycle/properties/roadmap'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
            stage:
                $id: '#/properties/project-lifecycle/properties/stage'
                type: string
                enum: ['active', 'inactive']
        required:
        - stage
        - bug-fixes-only
        type: object
    security-artifacts:
        $id: '#/properties/security-artifacts'
        additionalProperties: false
        properties:
            threat-model:
                $id: '#/properties/security-artifacts/properties/threat-model'
                additionalProperties: false
                properties:
                    evidence-url:
                        $id: '#/properties/security-artifacts/properties/threat-model/properties/evidence-url'
                        additionalItems: false
                        items:
                            $id: '#/properties/security-artifacts/properties/threat-model/properties/evidence-url/items'
                            anyOf:
                            -   $id: '#/properties/security-artifacts/properties/threat-model/properties/evidence-url/items/anyOf/0'
                                type: string
                                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
                        type: array
                    threat-model-created:
                        $id: '#/properties/security-artifacts/properties/threat-model/properties/threat-model-created'
                        type: boolean
                if:
                    properties:
                        threat-model-created:
                            const: true
                then:
                    required:
                    - evidence-url
                required:
                - threat-model-created
                type: object
        required:
        - threat-model
        type: object
    security-assessments:
        $id: '#/properties/security-assessments'
        additionalItems: false
        items:
            $id: '#/properties/security-assessments/items'
            anyOf:
            -   $id: '#/properties/security-assessments/items/anyOf/0'
                additionalProperties: false
                properties:
                    auditor-name:
                        $id: '#/properties/security-assessments/items/anyOf/0/properties/auditor-name'
                        type: string
                    auditor-report:
                        $id: '#/properties/security-assessments/items/anyOf/0/properties/auditor-report'
                        type: string
                        pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
                    auditor-url:
                        $id: '#/properties/security-assessments/items/anyOf/0/properties/auditor-url'
                        type: string
                        pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
                    report-year:
                        $id: '#/properties/security-assessments/items/anyOf/0/properties/report-year'
                        type: integer
                required:
                - auditor-name
                - auditor-url
                - report-year
                type: object
        type: array
    security-contacts:
        $id: '#/properties/security-contacts'
        additionalItems: false
        items:
            $id: '#/properties/security-contacts/items'
            anyOf:
            -   $id: '#/properties/security-contacts/items/anyOf/0'
                additionalProperties: false
                properties:
                    primary:
                        $id: '#/properties/security-contacts/items/anyOf/0/properties/primary'
                        type: boolean
                    type:
                        $id: '#/properties/security-contacts/items/anyOf/0/properties/type'
                        type: string
                        enum: ['email', 'phone', 'url']
                    value:
                        $id: '#/properties/security-contacts/items/anyOf/0/properties/value'
                        type: string
                        pattern: '^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}|https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)|[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$'
                required:
                - type
                - value
                type: object
        type: array
    security-testing:
        $id: '#/properties/security-testing'
        additionalItems: false
        items:
            $id: '#/properties/security-testing/items'
            anyOf:
            -   $id: '#/properties/security-testing/items/anyOf/0'
                additionalProperties: false
                properties:
                    integration:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/integration'
                        additionalProperties: false
                        properties:
                            ad-hoc:
                                $id: '#/properties/security-testing/items/anyOf/0/properties/integration/properties/ad-hoc'
                                type: boolean
                            before-release:
                                $id: '#/properties/security-testing/items/anyOf/0/properties/integration/properties/before-release'
                                type: boolean
                            ci:
                                $id: '#/properties/security-testing/items/anyOf/0/properties/integration/properties/ci'
                                type: boolean
                        required:
                        - ad-hoc
                        - ci
                        - before-release
                        type: object
                    tool-name:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/tool-name'
                        type: string
                    tool-rulesets:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/tool-rulesets'
                        additionalItems: true
                        items:
                            $id: '#/properties/security-testing/items/anyOf/0/properties/tool-rulesets/items'
                            anyOf:
                            -   $id: '#/properties/security-testing/items/anyOf/0/properties/tool-rulesets/items/anyOf/0'
                                type: string
                        type: array
                    tool-type:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/tool-type'
                        type: string
                        enum: ['sast', 'dast', 'iast', 'fuzzer']
                    tool-url:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/tool-url'
                        type: string
                        pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
                    tool-version:
                        $id: '#/properties/security-testing/items/anyOf/0/properties/tool-version'
                        type: string
                required:
                - tool-type
                - tool-name
                - tool-version
                - integration
                type: object
        type: array
    vulnerability-reporting:
        $id: '#/properties/vulnerability-reporting'
        additionalProperties: false
        properties:
            accepts-vulnerability-reports:
                $id: '#/properties/vulnerability-reporting/properties/accepts-vulnerability-reports'
                type: boolean
            bug-bounty-available:
                $id: '#/properties/vulnerability-reporting/properties/bug-bounty-available'
                type: boolean
            bug-bounty-url:
                $id: '#/properties/vulnerability-reporting/properties/bug-bounty-url'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
            email-contact:
                $id: '#/properties/vulnerability-reporting/properties/email-contact'
                type: string
                pattern: '^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$'
            security-policy:
                $id: '#/properties/vulnerability-reporting/properties/more-information'
                type: string
                pattern: 'https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)'
            pgp-key:
                $id: '#/properties/vulnerability-reporting/properties/pgp-key'
                type: string
                pattern: '^(-----BEGIN PGP PUBLIC KEY BLOCK-----).*([a-zA-Z0-9//\n\/\.\:\+\ \=]+).*(-----END PGP PUBLIC KEY BLOCK-----)$'
        if:
            properties:
                accepts-vulnerability-reports:
                    const: true
        then:
            required:
            - email-contact
            - security-policy
        required:
        - accepts-vulnerability-reports
        type: object
required:
- header
- project-lifecycle
- distribution-points
- security-artifacts
- security-contacts
- contribution-policy
- vulnerability-reporting
type: object